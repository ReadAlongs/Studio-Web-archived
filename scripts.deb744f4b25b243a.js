!function(Y,O){"object"==typeof exports&&"object"==typeof module?module.exports=O():"function"==typeof define&&define.amd?define("soundswallower",[],O):"object"==typeof exports?exports.soundswallower=O():Y.soundswallower=O()}(self,()=>(()=>{var Y={668:m=>{m.exports=function(g){return atob(g)}},545:m=>{"use strict";var g={};m.exports=function(c){if(typeof window>"u")return null;var h=window.OfflineAudioContext||window.webkitOfflineAudioContext,u=window.AudioContext||window.webkitAudioContext;if(!u)return null;"number"==typeof c&&(c={sampleRate:c});var n=c&&c.sampleRate;if(c&&c.offline)return h?new h(c.channels||2,c.length,n||44100):null;var i=g[n];if(i)return i;try{i=new u(c)}catch{i=new u}return g[i.sampleRate]=g[n]=i,i}},433:(m,g,c)=>{"use strict";const h=c(545),u=c(284);m.exports=function n(i,f,p){f instanceof Function&&(p=f,f={}),f||(f={});let b=f.context||h();return i instanceof Blob&&(i=new File([i],"decode")),i instanceof File?new Promise((v,x)=>{try{let w=new FileReader;w.readAsArrayBuffer(i),w.onload=()=>v(n(w.result,f,p))}catch(w){x(w)}}):(i instanceof ArrayBuffer||(i=u(i)),b.decodeAudioData(i.slice(),v=>{p&&p(null,v)},v=>{p&&p(v)}))}},823:m=>{m.exports=function(g){switch(g){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},582:(m,g,c)=>{var h=c(823);m.exports=function(u,n,i){if(!u)throw new TypeError("must specify data as first parameter");if(i=0|+(i||0),Array.isArray(u)&&u[0]&&"number"==typeof u[0][0]){var f,p,b,v,x=u[0].length,w=u.length*x;n&&"string"!=typeof n||(n=new(h(n||"float32"))(w+i));var j=n.length-i;if(w!==j)throw new Error("source length "+w+" ("+x+"x"+u.length+") does not match destination length "+j);for(f=0,b=i;f<u.length;f++)for(p=0;p<x;p++)n[b++]=null===u[f][p]?NaN:u[f][p]}else if(n&&"string"!=typeof n)n.set(u,i);else{var k=h(n||"float32");if(Array.isArray(u)||"array"===n)for(f=0,b=i,v=(n=new k(u.length+i)).length;b<v;b++,f++)n[b]=null===u[f]?NaN:u[f];else 0===i?n=new k(u):(n=new k(u.length+i)).set(u,i)}return n}},648:function(m,g){!function(c){"use strict";function h(u,n){if(u instanceof Boolean||"boolean"==typeof u||(n instanceof Object||(n={}),n.hasOwnProperty("allowBlank")&&!n.allowBlank&&""===u))return!1;var i="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return n.mime&&(i="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+i),!1===n.paddingRequired&&(i="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+i+"$","gi").test(u)}m.exports&&(g=m.exports=h),g.isBase64=h}()},626:m=>{m.exports=__dirname},483:(m,g,c)=>{var h,u=(h=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0,typeof __filename<"u"&&(h=h||__filename),function(n){var i,f;(n=void 0!==(n=n||{})?n:{}).ready=new Promise(function(r,e){i=r,f=e});var p,b,v,x,w,j,k=Object.assign({},n),K=[],Q="./this.program",nn=(r,e)=>{throw e},D="object"==typeof window,H="function"==typeof importScripts,z="";"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node?(z=H?c(704).dirname(z)+"/":__dirname+"/",j=()=>{w||(x=c(255),w=c(704))},p=function(r,e){return j(),r=w.normalize(r),x.readFileSync(r,e?void 0:"utf8")},v=r=>{var e=p(r,!0);return e.buffer||(e=new Uint8Array(e)),e},b=(r,e,t)=>{j(),r=w.normalize(r),x.readFile(r,function(a,s){a?t(a):e(s.buffer)})},process.argv.length>1&&(Q=process.argv[1].replace(/\\/g,"/")),K=process.argv.slice(2),process.on("uncaughtException",function(r){if(!(r instanceof un))throw r}),process.on("unhandledRejection",function(r){throw r}),nn=(r,e)=>{if(Fn())throw process.exitCode=r,e;var t;(t=e)instanceof un||B("exiting due to exception: "+t),process.exit(r)},n.inspect=function(){return"[Emscripten Module object]"}):(D||H)&&(H?z=self.location.href:typeof document<"u"&&document.currentScript&&(z=document.currentScript.src),h&&(z=h),z=0!==z.indexOf("blob:")?z.substr(0,z.replace(/[?#].*/,"").lastIndexOf("/")+1):"",p=r=>{var e=new XMLHttpRequest;return e.open("GET",r,!1),e.send(null),e.responseText},H&&(v=r=>{var e=new XMLHttpRequest;return e.open("GET",r,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),b=(r,e,t)=>{var a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType="arraybuffer",a.onload=()=>{200==a.status||0==a.status&&a.response?e(a.response):t()},a.onerror=t,a.send(null)});var N,In=n.print||console.log.bind(console),B=n.printErr||console.warn.bind(console);Object.assign(n,k),k=null,n.arguments&&(K=n.arguments),n.thisProgram&&(Q=n.thisProgram),n.quit&&(nn=n.quit),n.wasmBinary&&(N=n.wasmBinary);var en,Mn=n.noExitRuntime||!0;function cn(r,e="i8",t){switch("*"===e.charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return P[r>>0];case"i16":return pn[r>>1];case"i32":case"i64":return C[r>>2];case"float":return dn[r>>2];case"double":return Number(gn[r>>3]);default:q("invalid type for getValue: "+e)}return null}"object"!=typeof WebAssembly&&q("no native wasm support detected");var rn=!1;function tn(r,e,t,a,s){var R,M,o={string:function(R){var Tn,Dn,M=0;if(null!=R&&0!==R){var Un=1+(R.length<<2);Tn=R,Dn=M=J(Un),wn(Tn,W,Dn,Un)}return M},array:function(R){var M=J(R.length);return an(R,M),M}},_=n["_"+r],l=[],y=0;if(a)for(var d=0;d<a.length;d++){var U=o[t[d]];U?(0===y&&(y=kn()),l[d]=U(a[d])):l[d]=a[d]}return R=_.apply(null,l),0!==y&&Cn(y),M=R,"string"===e?G(M):"boolean"===e?Boolean(M):M}var mn,P,W,pn,C,dn,gn,hn=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function yn(r,e,t){for(var a=e+t,s=e;r[s]&&!(s>=a);)++s;if(s-e>16&&r.buffer&&hn)return hn.decode(r.subarray(e,s));for(var o="";e<s;){var _=r[e++];if(128&_){var l=63&r[e++];if(192!=(224&_)){var y=63&r[e++];if((_=224==(240&_)?(15&_)<<12|l<<6|y:(7&_)<<18|l<<12|y<<6|63&r[e++])<65536)o+=String.fromCharCode(_);else{var d=_-65536;o+=String.fromCharCode(55296|d>>10,56320|1023&d)}}else o+=String.fromCharCode((31&_)<<6|l)}else o+=String.fromCharCode(_)}return o}function G(r,e){return r?yn(W,r,e):""}function wn(r,e,t,a){if(!(a>0))return 0;for(var s=t,o=t+a-1,_=0;_<r.length;++_){var l=r.charCodeAt(_);if(l>=55296&&l<=57343&&(l=65536+((1023&l)<<10)|1023&r.charCodeAt(++_)),l<=127){if(t>=o)break;e[t++]=l}else if(l<=2047){if(t+1>=o)break;e[t++]=192|l>>6,e[t++]=128|63&l}else if(l<=65535){if(t+2>=o)break;e[t++]=224|l>>12,e[t++]=128|l>>6&63,e[t++]=128|63&l}else{if(t+3>=o)break;e[t++]=240|l>>18,e[t++]=128|l>>12&63,e[t++]=128|l>>6&63,e[t++]=128|63&l}}return e[t]=0,t-s}function F(r){var e=function(a){for(var s=0,o=0;o<a.length;++o){var _=a.charCodeAt(o);_>=55296&&_<=57343&&(_=65536+((1023&_)<<10)|1023&a.charCodeAt(++o)),_<=127?++s:s+=_<=2047?2:_<=65535?3:4}return s}(r)+1,t=J(e);return wn(r,P,t,e),t}function an(r,e){P.set(r,e)}function bn(r){mn=r,n.HEAP8=P=new Int8Array(r),n.HEAP16=pn=new Int16Array(r),n.HEAP32=C=new Int32Array(r),n.HEAPU8=W=new Uint8Array(r),n.HEAPU16=new Uint16Array(r),n.HEAPU32=new Uint32Array(r),n.HEAPF32=dn=new Float32Array(r),n.HEAPF64=gn=new Float64Array(r)}var vn,An=[],En=[],xn=[];function Fn(){return Mn}var A,sn,T=0,on=null,L=null;function q(r){n.onAbort&&n.onAbort(r),B(r="Aborted("+r+")"),rn=!0,r+=". Build with -s ASSERTIONS=1 for more info.";var e=new WebAssembly.RuntimeError(r);throw f(e),e}function zn(r){return r.startsWith("data:application/octet-stream;base64,")}function Rn(r){return r.startsWith("file://")}function Sn(r){try{if(r==A&&N)return new Uint8Array(N);if(v)return v(r);throw"both async and sync fetching of the wasm failed"}catch(e){q(e)}}function ln(r){for(;r.length>0;){var e=r.shift();if("function"!=typeof e){var t=e.func;"number"==typeof t?void 0===e.arg?jn(t)():jn(t)(e.arg):t(void 0===e.arg?null:e.arg)}else e(n)}}function jn(r){return vn.get(r)}n.preloadedImages={},n.preloadedAudios={},zn(A="assets/soundswallower.wasm")||(sn=A,A=n.locateFile?n.locateFile(sn,z):z+sn);var I={buffers:[null,[],[]],printChar:function(r,e){var t=I.buffers[r];0===e||10===e?((1===r?In:B)(yn(t,0)),t.length=0):t.push(e)},varargs:void 0,get:function(){return I.varargs+=4,C[I.varargs-4>>2]},getStr:function(r){return G(r)},get64:function(r,e){return r}};function On(r){try{return en.grow(r-mn.byteLength+65535>>>16),bn(en.buffer),1}catch{}}var _n={};function Z(){if(!Z.strings){var r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Q||"./this.program"};for(var e in _n)void 0===_n[e]?delete r[e]:r[e]=_n[e];var t=[];for(var e in r)t.push(e+"="+r[e]);Z.strings=t}return Z.strings}var V,Bn={d:function(r,e,t){return I.varargs=t,0},f:function(r,e){},h:function(r,e,t){return I.varargs=t,0},r:function(r,e,t,a){},e:function(r,e,t,a){I.varargs=a},s:function(r,e){},i:function(){return Date.now()},k:function(){throw 1/0},n:function(r,e,t,a,s,o,_,l){return-52},o:function(r,e,t,a,s,o){},t:function(){q("")},m:function(){return 2147483648},l:function(r){var e,t=W.length,a=2147483648;if((r>>>=0)>a)return!1;for(var s=1;s<=4;s*=2){var o=t*(1+.2/s);if(o=Math.min(o,r+100663296),On(Math.min(a,(e=Math.max(r,o))+(65536-e%65536)%65536)))return!0}return!1},p:function(r,e){var t=0;return Z().forEach(function(a,s){var o=e+t;C[r+4*s>>2]=o,function(_,l,y){for(var d=0;d<_.length;++d)P[l++>>0]=_.charCodeAt(d);P[l>>0]=0}(a,o),t+=a.length+1}),0},q:function(r,e){var t=Z();C[r>>2]=t.length;var a=0;return t.forEach(function(s){a+=s.length+1}),C[e>>2]=a,0},a:function(r){var a;a=r,Fn()||(n.onExit&&n.onExit(a),rn=!0),nn(a,new un(a))},b:function(r){return 0},g:function(r,e,t,a){var s=I.getStreamFromFD(r),o=I.doReadv(s,e,t);return C[a>>2]=o,0},j:function(r,e,t,a,s){},c:function(r,e,t,a){for(var s=0,o=0;o<t;o++){var _=C[e>>2],l=C[e+4>>2];e+=8;for(var y=0;y<l;y++)I.printChar(r,W[_+y]);s+=l}return C[a>>2]=s,0}},kn=(function(){var r={a:Bn};function e(s,o){n.asm=s.exports,bn((en=n.asm.u).buffer),vn=n.asm.G,En.unshift(n.asm.v),function(y){if(T--,n.monitorRunDependencies&&n.monitorRunDependencies(T),0==T&&(null!==on&&(clearInterval(on),on=null),L)){var d=L;L=null,d()}}()}function t(s){e(s.instance)}function a(s){return function(){if(!N&&(D||H)){if("function"==typeof fetch&&!Rn(A))return fetch(A,{credentials:"same-origin"}).then(function(o){if(!o.ok)throw"failed to load wasm binary file at '"+A+"'";return o.arrayBuffer()}).catch(function(){return Sn(A)});if(b)return new Promise(function(o,_){b(A,function(l){o(new Uint8Array(l))},_)})}return Promise.resolve().then(function(){return Sn(A)})}().then(function(o){return WebAssembly.instantiate(o,r)}).then(function(o){return o}).then(s,function(o){B("failed to asynchronously prepare wasm: "+o),q(o)})}if(T++,n.monitorRunDependencies&&n.monitorRunDependencies(T),n.instantiateWasm)try{return n.instantiateWasm(r,e)}catch(s){return B("Module.instantiateWasm callback failed with error: "+s),!1}(N||"function"!=typeof WebAssembly.instantiateStreaming||zn(A)||Rn(A)||"function"!=typeof fetch?a(t):fetch(A,{credentials:"same-origin"}).then(function(s){return WebAssembly.instantiateStreaming(s,r).then(t,function(o){return B("wasm streaming compile failed: "+o),B("falling back to ArrayBuffer instantiation"),a(t)})})).catch(f)}(),n.___wasm_call_ctors=function(){return(n.___wasm_call_ctors=n.asm.v).apply(null,arguments)},n._fsg_set_states=function(){return(n._fsg_set_states=n.asm.w).apply(null,arguments)},n._cmd_ln_hash_iter=function(){return(n._cmd_ln_hash_iter=n.asm.x).apply(null,arguments)},n._hash_iter_key=function(){return(n._hash_iter_key=n.asm.y).apply(null,arguments)},n._set_mdef=function(){return(n._set_mdef=n.asm.z).apply(null,arguments)},n._set_tmat=function(){return(n._set_tmat=n.asm.A).apply(null,arguments)},n._load_gmm=function(){return(n._load_gmm=n.asm.B).apply(null,arguments)},n._ptm_mgau_init_s3file=function(){return(n._ptm_mgau_init_s3file=n.asm.C).apply(null,arguments)},n._s3file_rewind=function(){return(n._s3file_rewind=n.asm.D).apply(null,arguments)},n._s2_semi_mgau_init_s3file=function(){return(n._s2_semi_mgau_init_s3file=n.asm.E).apply(null,arguments)},n._ms_mgau_init_s3file=function(){return(n._ms_mgau_init_s3file=n.asm.F).apply(null,arguments)},n._cmd_ln_str_r=function(){return(n._cmd_ln_str_r=n.asm.H).apply(null,arguments)},n._cmd_ln_float_r=function(){return(n._cmd_ln_float_r=n.asm.I).apply(null,arguments)},n._cmd_ln_int_r=function(){return(n._cmd_ln_int_r=n.asm.J).apply(null,arguments)},n._cmd_ln_retain=function(){return(n._cmd_ln_retain=n.asm.K).apply(null,arguments)},n._logmath_retain=function(){return(n._logmath_retain=n.asm.L).apply(null,arguments)},n._cmd_ln_free_r=function(){return(n._cmd_ln_free_r=n.asm.M).apply(null,arguments)},n._logmath_free=function(){return(n._logmath_free=n.asm.N).apply(null,arguments)},n._s3file_free=function(){return(n._s3file_free=n.asm.O).apply(null,arguments)},n._bin_mdef_read_s3file=function(){return(n._bin_mdef_read_s3file=n.asm.P).apply(null,arguments)},n._malloc=function(){return(n._malloc=n.asm.Q).apply(null,arguments)},n._free=function(){return(n._free=n.asm.R).apply(null,arguments)},n._cmd_ln_parse_r=function(){return(n._cmd_ln_parse_r=n.asm.S).apply(null,arguments)},n._cmd_ln_init=function(){return(n._cmd_ln_init=n.asm.T).apply(null,arguments)},n._cmd_ln_exists_r=function(){return(n._cmd_ln_exists_r=n.asm.U).apply(null,arguments)},n._cmd_ln_type_r=function(){return(n._cmd_ln_type_r=n.asm.V).apply(null,arguments)},n._cmd_ln_set_str_r=function(){return(n._cmd_ln_set_str_r=n.asm.W).apply(null,arguments)},n._cmd_ln_set_int_r=function(){return(n._cmd_ln_set_int_r=n.asm.X).apply(null,arguments)},n._cmd_ln_set_float_r=function(){return(n._cmd_ln_set_float_r=n.asm.Y).apply(null,arguments)},n._fsg_model_trans_add=function(){return(n._fsg_model_trans_add=n.asm.Z).apply(null,arguments)},n._fsg_model_tag_trans_add=function(){return(n._fsg_model_tag_trans_add=n.asm._).apply(null,arguments)},n._fsg_model_null_trans_add=function(){return(n._fsg_model_null_trans_add=n.asm.$).apply(null,arguments)},n._hash_table_iter_next=function(){return(n._hash_table_iter_next=n.asm.aa).apply(null,arguments)},n._fsg_model_word_id=function(){return(n._fsg_model_word_id=n.asm.ba).apply(null,arguments)},n._fsg_model_word_add=function(){return(n._fsg_model_word_add=n.asm.ca).apply(null,arguments)},n._logmath_log=function(){return(n._logmath_log=n.asm.da).apply(null,arguments)},n._fsg_model_init=function(){return(n._fsg_model_init=n.asm.ea).apply(null,arguments)},n._fsg_model_free=function(){return(n._fsg_model_free=n.asm.fa).apply(null,arguments)},n._fsg_model_retain=function(){return(n._fsg_model_retain=n.asm.ga).apply(null,arguments)},n._logmath_exp=function(){return(n._logmath_exp=n.asm.ha).apply(null,arguments)},n._jsgf_grammar_free=function(){return(n._jsgf_grammar_free=n.asm.ia).apply(null,arguments)},n._jsgf_get_rule=function(){return(n._jsgf_get_rule=n.asm.ja).apply(null,arguments)},n._jsgf_get_public_rule=function(){return(n._jsgf_get_public_rule=n.asm.ka).apply(null,arguments)},n._jsgf_build_fsg=function(){return(n._jsgf_build_fsg=n.asm.la).apply(null,arguments)},n._jsgf_parse_string=function(){return(n._jsgf_parse_string=n.asm.ma).apply(null,arguments)},n._logmath_init=function(){return(n._logmath_init=n.asm.na).apply(null,arguments)},n._ps_init_config=function(){return(n._ps_init_config=n.asm.oa).apply(null,arguments)},n._ps_args=function(){return(n._ps_args=n.asm.pa).apply(null,arguments)},n._ps_init_cleanup=function(){return(n._ps_init_cleanup=n.asm.qa).apply(null,arguments)},n._ps_init_fe=function(){return(n._ps_init_fe=n.asm.ra).apply(null,arguments)},n._ps_init_feat_s3file=function(){return(n._ps_init_feat_s3file=n.asm.sa).apply(null,arguments)},n._ps_init_acmod_pre=function(){return(n._ps_init_acmod_pre=n.asm.ta).apply(null,arguments)},n._ps_init_acmod_post=function(){return(n._ps_init_acmod_post=n.asm.ua).apply(null,arguments)},n._ps_init_dict_s3file=function(){return(n._ps_init_dict_s3file=n.asm.va).apply(null,arguments)},n._ps_set_fsg=function(){return(n._ps_set_fsg=n.asm.wa).apply(null,arguments)},n._ps_init_grammar_s3file=function(){return(n._ps_init_grammar_s3file=n.asm.xa).apply(null,arguments)},n._ps_set_jsgf_string=function(){return(n._ps_set_jsgf_string=n.asm.ya).apply(null,arguments)},n._ps_reinit_fe=function(){return(n._ps_reinit_fe=n.asm.za).apply(null,arguments)},n._ps_init=function(){return(n._ps_init=n.asm.Aa).apply(null,arguments)},n._ps_retain=function(){return(n._ps_retain=n.asm.Ba).apply(null,arguments)},n._ps_free=function(){return(n._ps_free=n.asm.Ca).apply(null,arguments)},n._ps_get_config=function(){return(n._ps_get_config=n.asm.Da).apply(null,arguments)},n._ps_get_logmath=function(){return(n._ps_get_logmath=n.asm.Ea).apply(null,arguments)},n._ps_add_word=function(){return(n._ps_add_word=n.asm.Fa).apply(null,arguments)},n._ps_lookup_word=function(){return(n._ps_lookup_word=n.asm.Ga).apply(null,arguments)},n._ps_start_utt=function(){return(n._ps_start_utt=n.asm.Ha).apply(null,arguments)},n._ps_process_float32=function(){return(n._ps_process_float32=n.asm.Ia).apply(null,arguments)},n._ps_end_utt=function(){return(n._ps_end_utt=n.asm.Ja).apply(null,arguments)},n._ps_get_hyp=function(){return(n._ps_get_hyp=n.asm.Ka).apply(null,arguments)},n._ps_seg_iter=function(){return(n._ps_seg_iter=n.asm.La).apply(null,arguments)},n._ps_seg_word=function(){return(n._ps_seg_word=n.asm.Ma).apply(null,arguments)},n._ps_seg_frames=function(){return(n._ps_seg_frames=n.asm.Na).apply(null,arguments)},n._ps_seg_prob=function(){return(n._ps_seg_prob=n.asm.Oa).apply(null,arguments)},n._ps_seg_next=function(){return(n._ps_seg_next=n.asm.Pa).apply(null,arguments)},n._ps_get_prob=function(){return(n._ps_get_prob=n.asm.Qa).apply(null,arguments)},n._ps_seg_free=function(){return(n._ps_seg_free=n.asm.Ra).apply(null,arguments)},n._s3file_init=function(){return(n._s3file_init=n.asm.Sa).apply(null,arguments)},n._tmat_init_s3file=function(){return(n._tmat_init_s3file=n.asm.Ta).apply(null,arguments)},n.stackSave=function(){return(kn=n.stackSave=n.asm.Ua).apply(null,arguments)}),Cn=n.stackRestore=function(){return(Cn=n.stackRestore=n.asm.Va).apply(null,arguments)},J=n.stackAlloc=function(){return(J=n.stackAlloc=n.asm.Wa).apply(null,arguments)};function un(r){this.name="ExitStatus",this.message="Program terminated with exit("+r+")",this.status=r}function fn(r){function e(){V||(V=!0,n.calledRun=!0,rn||(ln(En),i(n),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)t=n.postRun.shift(),xn.unshift(t);var t;ln(xn)}()))}r=r||K,T>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)t=n.preRun.shift(),An.unshift(t);var t;ln(An)}(),T>0||(n.setStatus?(n.setStatus("Running..."),setTimeout(function(){setTimeout(function(){n.setStatus("")},1),e()},1)):e()))}if(L=function r(){V||fn(),V||(L=r)},n.run=fn,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();fn(),void 0===n.defaultModel&&(n.defaultModel="en-us"),void 0===n.modelBase&&(n.modelBase=D?"model/":c(626));class Pn{constructor(e){if(this.cmd_ln=n._cmd_ln_parse_r(0,n._ps_args(),0,0,0),void 0===e){if(null===n.defaultModel)return;e={hmm:n.get_model_path(n.defaultModel)}}else null!==n.defaultModel&&("hmm"in e||(e.hmm=n.get_model_path(n.defaultModel)));for(const t in e)this.set(t,e[t])}delete(){this.cmd_ln&&n._cmd_ln_free_r(this.cmd_ln),this.cmd_ln=0}normalize_key(e){if(e.length>0){if("_"==e[0])return e;if("-"==e[0]){const t="_"+e.substr(1);return this.has(t)?t:e}{const t="_"+e;if(this.has(t))return t;const a="-"+e;return this.has(a)?a:e}}return""}normalize_ckey(e){const t=G(e);return 0==t.length?t:"-"==t[0]||"_"==t[0]?t.substr(1):t}set(e,t){const a=F(this.normalize_key(e)),s=n._cmd_ln_type_r(this.cmd_ln,a);if(0==s)throw new ReferenceError("Unknown cmd_ln parameter "+e);if(8&s){const o=F(t);n._cmd_ln_set_str_r(this.cmd_ln,a,o)}else if(4&s)n._cmd_ln_set_float_r(this.cmd_ln,a,t);else{if(!(18&s))return!1;n._cmd_ln_set_int_r(this.cmd_ln,a,t)}return!0}get(e){const t=F(this.normalize_key(e)),a=n._cmd_ln_type_r(this.cmd_ln,t);if(0==a)throw new ReferenceError("Unknown cmd_ln parameter "+e);if(8&a){const s=n._cmd_ln_str_r(this.cmd_ln,t);return 0==s?null:G(s)}if(4&a)return n._cmd_ln_float_r(this.cmd_ln,t);if(2&a)return n._cmd_ln_int_r(this.cmd_ln,t);if(16&a)return Boolean(n._cmd_ln_int_r(this.cmd_ln,t));throw new TypeError("Unsupported type "+a+" for parameter"+e)}model_file_path(e,t){const a=this.get(e);if(null!=a)return a;const s=this.get("hmm");if(null==s)throw new Error("Could not get "+e+" from config or model directory");return s+"/"+t}has(e){const t=F(e);return n._cmd_ln_exists_r(this.cmd_ln,t)}*[Symbol.iterator](){let e=n._cmd_ln_hash_iter(this.cmd_ln);const t=new Set;for(;0!=e;){const a=n._hash_iter_key(e),s=this.normalize_ckey(a);t.has(s)||(t.add(s),e=n._hash_table_iter_next(e),yield s)}}}async function E(r){let e;if(D){const s=await fetch(r);if(!s.ok)throw new Error("Failed to fetch "+r+" :"+s.statusText);{const o=await s.blob(),_=await o.arrayBuffer();e=new Uint8Array(_)}}else{const s=c(512),o=await s.readFile(r);e=new Uint8Array(o.buffer)}const t=e.length+1,a=n._malloc(t);if(0==a)throw new Error("Failed to allocate "+t+" bytes for "+r);return an(e,a),P[a+t]=0,n._s3file_init(a,t-1)}return n.get_model_path=function(r){return D?n.modelBase+r:c(704).join(n.modelBase,r)},n.Config=Pn,n.Decoder=class{constructor(r){if(this.config=r&&"object"==typeof r&&"cmd_ln"in r?r:new n.Config(...arguments),this.initialized=!1,this.ps=n._ps_init(0),0==this.ps)throw new Error("Failed to construct Decoder")}async initialize(r){if(0==this.ps)throw new Error("Decoder was somehow not constructed (ps==0)");void 0!==r&&(this.config&&this.config.delete(),this.config="object"==typeof r&&"cmd_ln"in r?r:new n.Config(...arguments)),await this.init_config(),await this.init_fe(),await this.init_feat(),await this.init_acmod(),await this.load_acmod_files(),await this.init_dict(),await this.init_grammar(),this.initialized=!0}async init_config(){await this.init_featparams();let r=n._ps_init_config(this.ps,this.config.cmd_ln);if(r<0)throw new Error("Failed to initialize basic configuration");if(r=n._ps_init_cleanup(this.ps),r<0)throw new Error("Failed to clean up decoder internals")}async init_featparams(){const r=this.config.model_file_path("featparams","feat.params");for await(const e of async function*(t){let a;if(D){const l=await fetch(t);if(!l.ok)throw new Error("Failed to fetch "+t+" :"+l.statusText);a=await l.text()}else a=await c(512).readFile(t,{encoding:"utf8"});const s=/^.*$/gm,o=/"([^"]*)"|'([^'])'|(\S+)/g;let _=null;for(const l of a.matchAll(s)){const y=l[0].trim();for(const d of y.matchAll(o)){const U=d[1]??d[2]??d[3];if("#"==U)break;null!==_?(yield[_,U],_=null):_=U}}if(null!==_)throw new Error("Odd number of arguments in "+t)}(r))this.config.has(e[0])&&this.config.set(e[0],e[1])}async init_fe(){if(0==n._ps_init_fe(this.ps))throw new Error("Failed to initialize frontend")}async init_feat(){let r;try{const e=this.config.model_file_path("lda","feature_transform"),t=await E(e);r=n._ps_init_feat_s3file(this.ps,t)}catch{r=n._ps_init_feat_s3file(this.ps,0)}if(0==r)throw new Error("Failed to initialize feature module")}async init_acmod(){if(0==n._ps_init_acmod_pre(this.ps))throw new Error("Failed to initialize acoustic model")}async load_acmod_files(){await this.load_mdef();const r=this.config.model_file_path("tmat","transition_matrices");await this.load_tmat(r);const e=this.config.model_file_path("mean","means"),t=this.config.model_file_path("var","variances"),a=this.config.model_file_path("sendump","sendump"),s=this.config.model_file_path("mixw","mixture_weights");if(await this.load_gmm(e,t,a,s),n._ps_init_acmod_post(this.ps)<0)throw new Error("Failed to initialize acoustic scoring")}async load_mdef(){var r,e;try{r=this.config.model_file_path("mdef","mdef.bin"),e=await E(r)}catch{try{r=this.config.model_file_path("mdef","mdef.txt"),e=await E(r)}catch{r=this.config.model_file_path("mdef","mdef"),e=await E(r)}}const t=n._bin_mdef_read_s3file(e,0);if(n._s3file_free(e),0==t)throw new Error("Failed to read mdef");n._set_mdef(this.ps,t)}async load_tmat(r){const e=await E(r),t=n._ps_get_logmath(this.ps),a=this.config.get("tmatfloor"),s=n._tmat_init_s3file(e,t,a);if(n._s3file_free(e),0==s)throw new Error("Failed to read tmat");n._set_tmat(this.ps,s)}async load_gmm(r,e,t,a){const s=await E(r),o=await E(e);var _,l;try{_=await E(t),l=0}catch{_=0,l=await E(a)}if(n._load_gmm(this.ps,s,o,l,_)<0)throw new Error("Failed to load GMM parameters")}async init_dict(){const r=this.config.model_file_path("dict","dict.txt"),e=await E(r);let t;try{const a=this.config.model_file_path("fdict","noisedict");t=await E(a)}catch{t=0}if(0==n._ps_init_dict_s3file(this.ps,e,t))throw new Error("Failed to initialize dictionaries")}async init_grammar(){let r=0,e=0;const t=this.config.get("jsgf");null!=t&&(e=await E(t));const a=this.config.get("fsg");if(null!=a&&(r=await E(a)),(r||e)&&n._ps_init_grammar_s3file(this.ps,r,e)<0)throw new Error("Failed to initialize grammar")}assert_initialized(){if(!this.initialized)throw new Error("Decoder not yet initialized")}async reinitialize_audio(){this.assert_initialized(),n._ps_reinit_fe(this.ps,0)}delete(){this.config&&this.config.delete(),this.ps&&n._ps_free(this.ps),this.ps=0}async start(){if(this.assert_initialized(),n._ps_start_utt(this.ps)<0)throw new Error("Failed to start utterance processing")}async stop(){if(this.assert_initialized(),n._ps_end_utt(this.ps)<0)throw new Error("Failed to stop utterance processing")}async process(r,e=!1,t=!1){this.assert_initialized();const a=r.length*r.BYTES_PER_ELEMENT,s=n._malloc(a);an(new Uint8Array(r.buffer),s);const o=n._ps_process_float32(this.ps,s,a/4,e,t);if(n._free(s),o<0)throw new Error("Utterance processing failed");return o}get_hyp(){return this.assert_initialized(),G(n._ps_get_hyp(this.ps,0))}get_hypseg(){this.assert_initialized();let r=n._ps_seg_iter(this.ps);const e=n._ps_get_config(this.ps),t=n._cmd_ln_int_r(e,F("-frate")),a=[];for(;0!=r;){const s=J(8);n._ps_seg_frames(r,s,s+4);const o=cn(s,"i32"),_=cn(s+4,"i32"),l={word:tn("ps_seg_word","string",["number"],[r]),start:o/t,end:_/t};a.push(l),r=n._ps_seg_next(r)}return a}lookup_word(r){this.assert_initialized();const e=F(r),t=n._ps_lookup_word(this.ps,e);return 0==t?null:G(t)}async add_word(r,e,t=!0){this.assert_initialized();const a=F(r),s=F(e),o=n._ps_add_word(this.ps,a,s,t);if(o<0)throw new Error("Failed to add word "+r+" with pronunciation "+e+" to the dictionary.");return o}create_fsg(r,e,t,a){this.assert_initialized();const s=n._ps_get_logmath(this.ps),o=n._ps_get_config(this.ps),_=n._cmd_ln_float_r(o,F("-lw"));let l=0;for(const d of a)l=Math.max(l,d.from,d.to);l++;const y=tn("fsg_model_init","number",["string","number","number","number"],[r,s,_,l]);n._fsg_set_states(y,e,t);for(const d of a){let U=0;if("prob"in d&&(U=n._logmath_log(s,d.prob)),"word"in d){const X=tn("fsg_model_word_add","number",["number","string"],[y,d.word]);if(-1==X)return n._fsg_model_free(y),0;n._fsg_model_trans_add(y,d.from,d.to,U,X)}else n._fsg_model_null_trans_add(y,d.from,d.to,U)}return{fsg:y,delete(){n._fsg_model_free(this.fsg),this.fsg=0}}}parse_jsgf(r,e=null){this.assert_initialized();const t=n._ps_get_logmath(this.ps),a=n._ps_get_config(this.ps),s=n._cmd_ln_float_r(a,F("-lw")),o=F(r),_=n._jsgf_parse_string(o,0);if(0==_)throw new Error("Failed to parse JSGF");let l;if(null!==e){const d=F(e);if(l=n._jsgf_get_rule(_,d),0==l)throw new Error("Failed to find top rule "+e)}else if(l=n._jsgf_get_public_rule(_),0==l)throw new Error("No public rules found in JSGF");const y=n._jsgf_build_fsg(_,l,t,s);return n._jsgf_grammar_free(_),{fsg:y,delete(){n._fsg_model_free(this.fsg),this.fsg=0}}}async set_fsg(r){if(this.assert_initialized(),0!=n._ps_set_fsg(this.ps,"_default",r.fsg))throw new Error("Failed to set FSG in decoder")}},n.ready});m.exports=u},634:(m,g,c)=>{"use strict";var h=c(668),u=c(648);function n(i){for(var f=new Uint8Array(i.length),p=0;p<i.length;p++)f[p]=i.charCodeAt(p);return f.buffer}m.exports=function(i){if("string"!=typeof i)throw Error("Argument should be a string");return/^data\:/i.test(i)?function(f){var p=(f=f.replace(/\r?\n/g,"")).indexOf(",");if(-1===p||p<=4)throw new TypeError("malformed data-URI");for(var b=f.substring(5,p).split(";"),v=!1,x="US-ASCII",w=0;w<b.length;w++)"base64"==b[w]?v=!0:0==b[w].indexOf("charset=")&&(x=b[w].substring(8));var j=unescape(f.substring(p+1));v&&(j=h(j));var k=n(j);return k.type=b[0]||"text/plain",k.charset=x,k}(i):(u(i)&&(i=h(i)),n(i))}},284:(m,g,c)=>{"use strict";var h=c(634),u=c(582);m.exports=function n(i){if(!i)return new ArrayBuffer;if(i instanceof ArrayBuffer)return i;if("string"==typeof i)return h(i);if(ArrayBuffer.isView(i))return null!=i.byteOffset?i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength):i.buffer;if(i.buffer||i.data||i._data)return n(i.buffer||i.data||i._data);if(null!=i.length)for(var f=0;f<i.length;f++)if(null!=i[f].length){i=u(i);break}return new Uint8Array(null!=i.length?i:[i]).buffer}},364:(m,g,c)=>{"use strict";var h,u=null;m.exports={initialize:async function(n){return h=await c(483)(),(u=new h.Decoder(n)).initialize()},align:async function(n,i){u.config.get("samprate")!=n.sampleRate&&(u.config.set("samprate",n.sampleRate),await u.reinitialize_audio()),console.log(u.config.get("samprate")),console.log(n.sampleRate),await u.start(),await u.process(n.getChannelData(0),!1,!0),await u.stop();let f=u.get_hypseg();return console.log(f),f},addDict:async function(n){let i=n.length;Object.keys(n).map(async(f,p)=>{console.log("adding dictionary entry for "+f+" equal to "+n[f]),await u.add_word(f,n[f],p===i-1)}),console.log("finished adding words")},createGrammarFromJSGF:async function(n){const i=u.parse_jsgf(n);await u.set_fsg(i),i.delete(),console.log("finished creating grammar")}}},255:()=>{},512:()=>{},704:()=>{}},O={};function S(m){var g=O[m];if(void 0!==g)return g.exports;var c=O[m]={exports:{}};return Y[m].call(c.exports,c,c.exports,S),c.exports}S.d=(m,g)=>{for(var c in g)S.o(g,c)&&!S.o(m,c)&&Object.defineProperty(m,c,{enumerable:!0,get:g[c]})},S.o=(m,g)=>Object.prototype.hasOwnProperty.call(m,g),S.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var $={};return(()=>{"use strict";S.r($),S.d($,{align:()=>n,aligner:()=>g,aligner_ready:()=>c,createFSG:()=>u,decode:()=>m,initialize:()=>h});var m=S(433),g=S(364);let c=!1;async function h(i){try{const f=await g.initialize(i);return console.log("Speech recognition ready"),c=!0,f}catch(f){console.log("Error initializing speech aligner: "+f.message)}}async function u(i,f){try{await g.addDict(f),console.log("Added words to dictionary")}catch(p){return console.log("Error adding words to dictionary: "+p.message),!1}try{await g.createGrammarFromJSGF(i),console.log("Added grammar")}catch(p){return console.log("Error adding grammar: "+p.message),!1}console.log("Grammar ready.")}async function n(i,f){try{let p=await g.align(i,f);return console.log("Recognition finished"),p}catch(p){console.log("Error performing recognition: "+p.message)}}})(),$})());